# 課題3

## Table of Contents
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<details>
<summary>Details</summary>

- [XSS](#xss)
- [コマンドインジェクション](#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3)
- [SQLインジェクション](#sql%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3)
- [CSRF](#csrf)

</details>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## XSS

- 入力値
  - `<script>alert("cracked")</script>`
  - フォームに入力された文字列を何の対策もせずにそのまま実行した結果、JavaScriptが実行されてしまっている

- 結果

![](../../../assets/dvwa_xss.png)

## コマンドインジェクション

- 入力値
  - `|| cat /etc/passwd`
  - `||`：OR演算子（前のコマンドが失敗した場合に、この後のコマンドが実行される）

- 結果

![](../../../assets/dvwa_command_injection.png)

## SQLインジェクション

- 入力値
  - `1' OR 'a'='a`
  - プレースホルダなどなしで、入力値をそのままSELECT文に挿入した結果、以下のようなSQLを実行した結果を返していると考えられる。OR後の`'a' = 'a'`は正しいので、結果的にテーブル内のユーザ名が全て表示されてしまっている。

```sql
SELECT first_name, surname FROM <テーブル名> WHERE userid = 1 OR 'a' = 'a';
```

- 結果

![](../../../assets/dvwa_sql_injection.png)

## CSRF

- 実施すること
  1. DVMAのサイトで、パスワードをadmin以外に変更して、ログアウトする（Dockerで起動することを想定しています）
  2. [csrf.html](../task_3/csrf.html)をブラウザで開く
  3. Changeボタンを押下してパスワードを変更する
  4. DVMAのサイトのログイン画面を開き、adminの前のパスワードでログインする

- 結果
  - admin前のパスワードでログインできなくなっており、adminではログインできる
    - つまりCSRF攻撃によりパスワードが変更されてしまった。

![](../../../assets/dvwa_login_fail.png)

- 参考
  - [DVWAでCSRF(Low)](https://cysec148.hatenablog.com/entry/2019/11/05/173122)